{% load i18n static admin_datta %}

<nav class="pc-sidebar">
  <div class="navbar-wrapper">
    <div class="m-header">
      <a href="{% url 'index' %}" class="b-brand text-primary d-flex align-items-center">
        <img src="{% static 'assets/images/favicon.svg' %}" class="img-fluid me-2" alt="logo" style="height: 40px;">
        <h1 class="text-primary fs-4 mb-0">{{ configuracion.nombre_negocio }}</h1>
      </a>
    </div>

    <div class="navbar-content">
      <ul class="pc-navbar">

        {% if request.user.is_superuser %}
        <li class="pc-item pc-caption"><label>ADMIN</label></li>
        <li class="pc-item">
          <a href="{% url 'admin:index' %}" class="pc-link">
            <span class="pc-micon"><i data-feather="settings"></i></span>
            <span class="pc-mtext">Superuser UI</span>
          </a>
        </li>
        {% endif %}

        <li class="pc-item pc-caption"><label>Páginas</label></li>

        <!-- Dashboard -->
        <li class="pc-item">
          <a href="{% url 'resumen_financiero' %}" class="pc-link">
            <span class="pc-micon"><i data-feather="home"></i></span>
            <span class="pc-mtext">Dashboard</span>
          </a>
        </li>

        <!-- Bodega -->
        <li class="pc-item pc-hasmenu">
          <a href="#!" class="pc-link">
            <span class="pc-micon"><i data-feather="archive"></i></span>
            <span class="pc-mtext">Bodega</span>
            <span class="pc-arrow"><i class="ti ti-chevron-right"></i></span>
          </a>
          <ul class="pc-submenu">
            <li class="pc-item"><a class="pc-link" href="{% url 'lista_categorias' %}"><i data-feather="layers"></i> Categorías</a></li>
            <li class="pc-item"><a class="pc-link" href="{% url 'compras_list' %}"><i data-feather="shopping-bag"></i> Compras</a></li>
            <li class="pc-item"><a class="pc-link" href="{% url 'lista_productos' %}"><i data-feather="package"></i> Productos</a></li>
            <li class="pc-item"><a class="pc-link" href="{% url 'proveedor_list' %}"><i data-feather="truck"></i> Proveedores</a></li>
          </ul>
        </li>

        <!-- Facturación -->
        <li class="pc-item pc-hasmenu">
          <a href="#!" class="pc-link">
            <span class="pc-micon"><i data-feather="file-text"></i></span>
            <span class="pc-mtext">Facturación</span>
            <span class="pc-arrow"><i class="ti ti-chevron-right"></i></span>
          </a>
          <ul class="pc-submenu">
            <li class="pc-item"><a class="pc-link" href="{% url 'listar_clientes' %}"><i data-feather="users"></i> Clientes</a></li>
            <li class="pc-item"><a class="pc-link" href="#!"><i data-feather="gift"></i> Promociones</a></li>
            <li class="pc-item"><a class="pc-link" href="{% url 'ventas_list' %}"><i data-feather="shopping-cart"></i> Ventas</a></li>
          </ul>
        </li>

        <!-- Reportes -->
        <li class="pc-item pc-hasmenu">
          <a href="#!" class="pc-link">
            <span class="pc-micon"><i data-feather="bar-chart-2"></i></span>
            <span class="pc-mtext">Reportes</span>
            <span class="pc-arrow"><i class="ti ti-chevron-right"></i></span>
          </a>
          <ul class="pc-submenu">
            <li class="pc-item"><a href="{% url 'imprimir_ventas' %}" class="pc-link" target="_blank"><i data-feather="file-text"></i> 🧾 Imprimir Ventas</a></li>
            <li class="pc-item"><a href="{% url 'imprimir_compras' %}" class="pc-link" target="_blank"><i data-feather="shopping-bag"></i> 📦 Imprimir Compras</a></li>
            <li class="pc-item"><a href="{% url 'imprimir_productos' %}" class="pc-link" target="_blank"><i data-feather="package"></i> 🏷️ Imprimir Productos</a></li>
            <li class="pc-item"><a href="{% url 'reporte_completo' %}" class="pc-link" target="_blank"><i data-feather="activity"></i> 📊 Reporte Completo</a></li>
          </ul>
        </li>

        <!-- Opciones del Sistema -->
        {% if request.user.is_authenticated %}
        <li class="pc-item">
          <button class="pc-link btn btn-primary w-100 text-start" type="button" onclick="toggleOpcionesSistema()">
            <span class="pc-micon"><i data-feather="settings"></i></span>
            <span class="pc-mtext">Opciones del Sistema</span>
          </button>

          <div id="opcionesSistema" style="margin-left: 20px; margin-top: 5px;">

  <!-- Detener Servidor (visible para todos) -->
  <form action="{% url 'detener_servidor' %}" method="post" style="margin-bottom:5px;">
    {% csrf_token %}
    <button type="submit" class="btn btn-warning w-100" onclick="return confirm('¿Seguro que quieres detener el servidor?')">
      🟠 Detener Servidor
    </button>
  </form>

  <!-- Reiniciar Servidor (visible para todos) -->
  <form action="{% url 'reiniciar_servidor' %}" method="post" style="margin-bottom:5px;">
    {% csrf_token %}
    <button type="submit" class="btn btn-success w-100" onclick="return confirm('¿Seguro que quieres reiniciar el servidor?')">
      🔄 Reiniciar Servidor
    </button>
  </form>

  <!-- Backups (solo superusuario) -->
  {% if request.user.is_superuser %}
  <a href="{% url 'admin:inventario_backupmanager_changelist' %}" class="btn btn-info w-100 mb-1">
    💾 Gestionar Backups
  </a>
  {% endif %}

</div>

        </li>
        <script>
          function toggleOpcionesSistema() {
            const contenedor = document.getElementById("opcionesSistema");
            contenedor.style.display = (contenedor.style.display === "none" || contenedor.style.display === "") ? "block" : "none";
          }
        </script>
        {% endif %}

      </ul>
    </div>
  </div>
</nav>
